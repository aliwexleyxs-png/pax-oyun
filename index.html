<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>TarihSenaryosu_AI - Tek KiÅŸilik Strateji</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #0f172a;
      color: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 16px;
    }

    .game {
      background: #020617;
      border-radius: 16px;
      padding: 20px;
      max-width: 700px;
      width: 100%;
      box-shadow: 0 20px 50px rgba(0,0,0,0.6);
      border: 1px solid #1f2937;
    }

    /* START SCREEN */
    .start-screen {
      text-align: center;
      padding: 24px 10px;
    }

    .start-title {
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .start-subtitle {
      font-size: 0.95rem;
      color: #9ca3af;
      margin-bottom: 18px;
    }

    .start-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.8rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: #111827;
      border: 1px solid #1f2937;
      margin-bottom: 10px;
      color: #a5b4fc;
    }

    .start-buttons {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 10px;
      margin-bottom: 10px;
    }

    .btn {
      border-radius: 999px;
      padding: 9px 14px;
      border: 1px solid #1f2937;
      cursor: pointer;
      font-size: 0.9rem;
      transition: transform 0.1s, box-shadow 0.1s, border-color 0.15s, background 0.15s;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: #e5e7eb;
      border-color: #4f46e5;
    }

    .btn-primary:hover {
      box-shadow: 0 10px 25px rgba(79,70,229,0.45);
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: #020617;
      color: #e5e7eb;
    }

    .btn-secondary:hover {
      border-color: #4b5563;
      transform: translateY(-1px);
    }

    .start-hint {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 4px;
    }

    .start-footer {
      margin-top: 12px;
      font-size: 0.75rem;
      color: #4b5563;
    }

    /* GAME SCREEN */
    #gameScreen {
      display: none;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .title {
      font-size: 1.4rem;
      font-weight: 700;
    }

    .turn-info {
      font-size: 0.9rem;
      color: #9ca3af;
      text-align: right;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-bottom: 16px;
    }

    .stat {
      background: #020617;
      border-radius: 10px;
      padding: 8px;
      border: 1px solid #1f2937;
    }

    .stat-label {
      font-size: 0.75rem;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    .stat-value {
      font-weight: 600;
      font-size: 0.95rem;
    }

    .bar {
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: #111827;
      margin-top: 4px;
      overflow: hidden;
    }

    .bar-fill {
      height: 100%;
      background: #22c55e;
      transition: width 0.3s;
    }

    .event-box {
      background: linear-gradient(135deg, #020617, #020617, #0b1120);
      border-radius: 12px;
      padding: 14px;
      border: 1px solid #1f2937;
      margin-bottom: 16px;
    }

    .event-title {
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 1.05rem;
    }

    .event-text {
      font-size: 0.95rem;
      color: #d1d5db;
    }

    .choices {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 10px;
      margin-top: 10px;
    }

    button.choice {
      background: #111827;
      border-radius: 999px;
      border: 1px solid #1f2937;
      padding: 8px 12px;
      cursor: pointer;
      text-align: left;
      font-size: 0.9rem;
      color: #e5e7eb;
      transition: transform 0.1s, box-shadow 0.1s, border-color 0.2s, background 0.15s;
    }

    button.choice:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.4);
      border-color: #6366f1;
    }

    button.choice:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .result {
      font-size: 0.9rem;
      margin-bottom: 6px;
      color: #a5b4fc;
    }

    .game-over {
      text-align: center;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed #1f2937;
      font-size: 0.95rem;
    }

    .btn-row {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin-top: 8px;
    }

    .small-btn {
      flex: 1;
      background: #020617;
      border-radius: 999px;
      border: 1px solid #1f2937;
      padding: 6px 10px;
      cursor: pointer;
      font-size: 0.75rem;
      color: #9ca3af;
      text-align: center;
    }

    .small-btn:hover {
      border-color: #4b5563;
    }

    .log {
      background: #020617;
      border-radius: 10px;
      padding: 10px;
      font-size: 0.8rem;
      max-height: 140px;
      overflow-y: auto;
      border: 1px solid #111827;
    }

    .log-entry {
      margin-bottom: 4px;
      color: #9ca3af;
    }

    .log-entry strong {
      color: #e5e7eb;
    }

    @media (max-width: 600px) {
      .stats {
        grid-template-columns: repeat(2, 1fr);
      }
      .title {
        font-size: 1.1rem;
      }
    }
  </style>
</head>
<body>
  <div class="game">
    <!-- START SCREEN -->
    <div id="startScreen" class="start-screen">
      <div class="start-badge">
        <span>ğŸ§ </span>
        <span>tarihsenaryosu_ai â€¢ prototip</span>
      </div>
      <div class="start-title">ğŸ“œ Tarih Senaryosu</div>
      <div class="start-subtitle">
        Tek kiÅŸilik bir strateji simÃ¼lasyonunda kendi devletini yÃ¶net.  
        Her karar; ekonomi, ordu, halk ve istikrarÄ± deÄŸiÅŸtirecek.
      </div>

      <div class="start-buttons">
        <button id="newGameBtn" class="btn btn-primary">Yeni oyun baÅŸlat</button>
        <button id="continueBtn" class="btn btn-secondary">KaldÄ±ÄŸÄ±m yerden devam et</button>
      </div>

      <div class="start-hint">
        Ä°lerleyiÅŸin tarayÄ±cÄ±na kaydedilir. SayfayÄ± kapatsan bile geri dÃ¶nebilirsin.
      </div>
      <div class="start-footer">
        v0.1 â€¢ mekanikler deneme aÅŸamasÄ±nda
      </div>
    </div>

    <!-- GAME SCREEN -->
    <div id="gameScreen">
      <div class="header">
        <div class="title">ğŸ“œ TarihSenaryosu_AI</div>
        <div class="turn-info">
          YÄ±l: <span id="year">1453</span><br>
          Tur: <span id="turn">1</span>
        </div>
      </div>

      <div class="stats">
        <div class="stat">
          <div class="stat-label">Ekonomi</div>
          <div class="stat-value" id="economyValue">50</div>
          <div class="bar"><div class="bar-fill" id="economyBar"></div></div>
        </div>
        <div class="stat">
          <div class="stat-label">Ordu</div>
          <div class="stat-value" id="militaryValue">50</div>
          <div class="bar"><div class="bar-fill" id="militaryBar"></div></div>
        </div>
        <div class="stat">
          <div class="stat-label">Halk MutluluÄŸu</div>
          <div class="stat-value" id="happinessValue">50</div>
          <div class="bar"><div class="bar-fill" id="happinessBar"></div></div>
        </div>
        <div class="stat">
          <div class="stat-label">Ä°stikrar</div>
          <div class="stat-value" id="stabilityValue">50</div>
          <div class="bar"><div class="bar-fill" id="stabilityBar"></div></div>
        </div>
      </div>

      <div class="event-box">
        <div class="event-title" id="eventTitle">Yeni hÃ¼kÃ¼mdarsÄ±n!</div>
        <div class="event-text" id="eventText">
          Anadolu'da yeni bir devletin baÅŸÄ±na geÃ§tin. VerdiÄŸin her karar, tarihin akÄ±ÅŸÄ±nÄ± deÄŸiÅŸtirecek.
        </div>

        <div class="choices" id="choices"></div>

        <div class="result" id="resultText"></div>

        <div class="game-over" id="gameOver" style="display:none;"></div>

        <div class="btn-row">
          <button class="small-btn" id="nextTurnBtn">Sonraki olayÄ± getir</button>
          <button class="small-btn" id="restartBtn">Yeniden baÅŸla</button>
        </div>
      </div>

      <div class="log" id="log"></div>
    </div>
  </div>

  <script>
    const SAVE_KEY = "tarihSenaryosu_ai_save";

    // Oyun durumu
    const state = {
      year: 1453,
      turn: 1,
      economy: 50,
      military: 50,
      happiness: 50,
      stability: 50,
      alive: true
    };

    // DOM referanslarÄ±
    const startScreen = document.getElementById("startScreen");
    const gameScreen = document.getElementById("gameScreen");
    const newGameBtn = document.getElementById("newGameBtn");
    const continueBtn = document.getElementById("continueBtn");

    const yearSpan = document.getElementById("year");
    const turnSpan = document.getElementById("turn");

    const economyValue = document.getElementById("economyValue");
    const militaryValue = document.getElementById("militaryValue");
    const happinessValue = document.getElementById("happinessValue");
    const stabilityValue = document.getElementById("stabilityValue");

    const economyBar = document.getElementById("economyBar");
    const militaryBar = document.getElementById("militaryBar");
    const happinessBar = document.getElementById("happinessBar");
    const stabilityBar = document.getElementById("stabilityBar");

    const eventTitle = document.getElementById("eventTitle");
    const eventText = document.getElementById("eventText");
    const choicesDiv = document.getElementById("choices");
    const resultText = document.getElementById("resultText");
    const logDiv = document.getElementById("log");
    const gameOverDiv = document.getElementById("gameOver");

    const nextTurnBtn = document.getElementById("nextTurnBtn");
    const restartBtn = document.getElementById("restartBtn");

    // Olay havuzu (aynÄ±)
    const events = [
      {
        title: "Vergi Reformu",
        text: "Hazine boÅŸalmak Ã¼zere. DanÄ±ÅŸmanlarÄ±n vergi sistemini deÄŸiÅŸtirmeyi Ã¶neriyor.",
        choices: [
          {
            text: "Zenginlerin vergisini artÄ±r.",
            effects: { economy: +5, happiness: -5, stability: -2 },
            result: "Hazine biraz doldu ama elit kesim homurdanmaya baÅŸladÄ±."
          },
          {
            text: "Halktan ek vergi al.",
            effects: { economy: +8, happiness: -10, stability: -5 },
            result: "KÄ±sa vadede hazine doldu fakat halkÄ±n Ã¶fkesi bÃ¼yÃ¼yor."
          },
          {
            text: "Vergi sistemine dokunma.",
            effects: { economy: 0, happiness: +3, stability: +2 },
            result: "Kimseyi kÄ±zdÄ±rmadÄ±n ama sorunlar ertelendi."
          }
        ]
      },
      {
        title: "Orduya YatÄ±rÄ±m",
        text: "SÄ±nÄ±rda komÅŸu devletin orduyu gÃ¼Ã§lendirdiÄŸi haberi geliyor.",
        choices: [
          {
            text: "Ordunun sayÄ±sÄ±nÄ± artÄ±r.",
            effects: { military: +10, economy: -7, stability: +2 },
            result: "Ordu gÃ¼Ã§lendi ama bÃ¼tÃ§e zorlandÄ±."
          },
          {
            text: "Yeni bir kale inÅŸa et.",
            effects: { military: +7, economy: -5, stability: +3 },
            result: "Savunma gÃ¼vence altÄ±nda, halk kendini daha gÃ¼vende hissediyor."
          },
          {
            text: "HiÃ§bir ÅŸey yapma, izlemeye devam et.",
            effects: { military: 0, stability: -4 },
            result: "KomÅŸu devlet cesaretlendi, sarayda endiÅŸe arttÄ±."
          }
        ]
      },
      {
        title: "KÄ±tlÄ±k Tehlikesi",
        text: "Bu sene yaÄŸÄ±ÅŸlar az oldu. KÄ±tlÄ±k ihtimali konuÅŸuluyor.",
        choices: [
          {
            text: "Depolardaki tahÄ±lÄ± halka daÄŸÄ±t.",
            effects: { happiness: +10, economy: -8, stability: +3 },
            result: "Halk seni sevgiyle anÄ±yor ama hazine zorlandÄ±."
          },
          {
            text: "TahÄ±lÄ± yÃ¼ksek fiyata sat.",
            effects: { economy: +12, happiness: -12, stability: -4 },
            result: "Hazine doldu ama aÃ§ kalanlar isyan etmeye baÅŸladÄ±."
          },
          {
            text: "KomÅŸu devletten tahÄ±l satÄ±n al.",
            effects: { economy: -5, happiness: +4, stability: +1 },
            result: "AÃ§lÄ±k hafifledi, dÄ±ÅŸa baÄŸÄ±mlÄ±lÄ±k biraz arttÄ±."
          }
        ]
      },
      {
        title: "Medrese AÃ§Ä±lmasÄ±",
        text: "Ã‚limler, ÅŸehirde yeni bir medrese aÃ§Ä±lmasÄ± iÃ§in destek istiyor.",
        choices: [
          {
            text: "Medreseyi devlet bÃ¼tÃ§esinden finanse et.",
            effects: { economy: -5, stability: +6, happiness: +4 },
            result: "Bilim ve ilim geliÅŸti, toplumda itibarÄ±n arttÄ±."
          },
          {
            text: "Zenginlerden baÄŸÄ±ÅŸ toplanmasÄ±nÄ± emret.",
            effects: { economy: 0, happiness: +2, stability: +2 },
            result: "Halk memnun, zenginler ince bir sitemde bulundu."
          },
          {
            text: "Bu sene bÃ¼tÃ§e yok, erteleyin.",
            effects: { stability: -3, happiness: -2 },
            result: "Ã‚limler kÄ±rÄ±ldÄ±, itibarÄ±n biraz zedelendi."
          }
        ]
      },
      {
        title: "Saray EntrikasÄ±",
        text: "Saray iÃ§inde bazÄ± vezirlerin sana karÅŸÄ± gizli ittifak kurduÄŸu sÃ¶yleniyor.",
        choices: [
          {
            text: "SoruÅŸturma aÃ§ ve suÃ§lularÄ± cezalandÄ±r.",
            effects: { stability: +5, happiness: -3 },
            result: "Ä°hanet bastÄ±rÄ±ldÄ± ama sarayda korku havasÄ± esti."
          },
          {
            text: "Onlarla pazarlÄ±k yap, yetkilerini paylaÅŸ.",
            effects: { stability: -2, happiness: +3, economy: +2 },
            result: "GeÃ§ici bir denge saÄŸlandÄ± ama otoriten azaldÄ±."
          },
          {
            text: "GÃ¶rmezden gel, zamanla daÄŸÄ±lÄ±r um.",
            effects: { stability: -6 },
            result: "Entrikalar bÃ¼yÃ¼dÃ¼, tahtÄ±n sallanmaya baÅŸladÄ±."
          }
        ]
      },
      {
        title: "Ticaret YollarÄ±",
        text: "Bir tÃ¼ccarlar heyeti, yeni ticaret anlaÅŸmalarÄ± teklif ediyor.",
        choices: [
          {
            text: "Ticaret vergilerini dÃ¼ÅŸÃ¼r, ticareti teÅŸvik et.",
            effects: { economy: +10, happiness: +4, stability: +2 },
            result: "Åehrin Ã§arÅŸÄ±larÄ± canlandÄ±, hazinen uzun vadede gÃ¼Ã§lenecek."
          },
          {
            text: "YÃ¼ksek vergi koy, kÄ±sa sÃ¼rede gelir elde et.",
            effects: { economy: +8, happiness: -5 },
            result: "TÃ¼ccarlar homurdansa da hazine sevindi."
          },
          {
            text: "Ticareti kÄ±sÄ±tla, iÃ§eride Ã¼retime odaklan.",
            effects: { economy: -4, stability: +4 },
            result: "DÄ±ÅŸ ticaret azaldÄ± ama iÃ§ dÃ¼zen biraz daha kontrol altÄ±nda."
          }
        ]
      }
    ];

    function clamp(value) {
      if (value < 0) return 0;
      if (value > 100) return 100;
      return value;
    }

    function updateStatsUI() {
      economyValue.textContent = state.economy;
      militaryValue.textContent = state.military;
      happinessValue.textContent = state.happiness;
      stabilityValue.textContent = state.stability;

      economyBar.style.width = state.economy + "%";
      militaryBar.style.width = state.military + "%";
      happinessBar.style.width = state.happiness + "%";
      stabilityBar.style.width = state.stability + "%";

      [economyBar, militaryBar, happinessBar, stabilityBar].forEach(bar => {
        const w = parseInt(bar.style.width) || 0;
        if (w < 25) {
          bar.style.background = "#ef4444"; // kÄ±rmÄ±zÄ±
        } else if (w < 60) {
          bar.style.background = "#f59e0b"; // turuncu
        } else {
          bar.style.background = "#22c55e"; // yeÅŸil
        }
      });

      yearSpan.textContent = state.year;
      turnSpan.textContent = state.turn;
    }

    function addLogEntry(text) {
      const div = document.createElement("div");
      div.className = "log-entry";
      div.innerHTML = text;
      logDiv.prepend(div);
    }

    function saveGame() {
      try {
        localStorage.setItem(SAVE_KEY, JSON.stringify(state));
      } catch (e) {
        // sessiz geÃ§
      }
    }

    function clearSave() {
      try {
        localStorage.removeItem(SAVE_KEY);
      } catch (e) {
        // sessiz geÃ§
      }
    }

    function loadGame() {
      try {
        const raw = localStorage.getItem(SAVE_KEY);
        if (!raw) return null;
        const data = JSON.parse(raw);
        const required = ["year", "turn", "economy", "military", "happiness", "stability", "alive"];
        for (const key of required) {
          if (typeof data[key] === "undefined") return null;
        }
        return data;
      } catch (e) {
        return null;
      }
    }

    function checkGameOver() {
      if (!state.alive) return true;

      const collapsed =
        state.economy <= 0 ||
        state.military <= 0 ||
        state.happiness <= 0 ||
        state.stability <= 0;

      if (collapsed) {
        state.alive = false;
        const summary = `Toplam ${state.turn} tur dayanabildin, ${state.year}. yÄ±la kadar hÃ¼kÃ¼m sÃ¼rdÃ¼n.`;
        gameOverDiv.style.display = "block";
        gameOverDiv.innerHTML =
          "âš  Devlet Ã§Ã¶ktÃ¼! Ä°Ã§ karÄ±ÅŸÄ±klÄ±klar ve krizler yÃ¶netilemedi.<br>" +
          summary +
          "<br>Yeni bir kader yazmak iÃ§in 'Yeniden baÅŸla'ya tÄ±kla.";
        nextTurnBtn.disabled = true;
        clearSave();
        return true;
      }

      if (state.turn > 25) {
        state.alive = false;
        const summary = `Toplam ${state.turn - 1} tur boyunca hÃ¼kÃ¼m sÃ¼rdÃ¼n, ${state.year - 1}. yÄ±la kadar istikrar saÄŸladÄ±n.`;
        gameOverDiv.style.display = "block";
        gameOverDiv.innerHTML =
          "ğŸ† Tebrikler! On yÄ±llarca hÃ¼kÃ¼m sÃ¼rdÃ¼n ve adÄ±n kroniklere 'BÃ¼yÃ¼k HÃ¼kÃ¼mdar' olarak geÃ§ti.<br>" +
          summary;
        nextTurnBtn.disabled = true;
        clearSave();
        return true;
      }

      return false;
    }

    let currentEvent = null;

    function showRandomEvent() {
      if (!state.alive) return;

      resultText.textContent = "";
      gameOverDiv.style.display = "none";

      const event = events[Math.floor(Math.random() * events.length)];
      currentEvent = event;

      eventTitle.textContent = event.title;
      eventText.textContent = event.text;

      choicesDiv.innerHTML = "";

      event.choices.forEach(choice => {
        const btn = document.createElement("button");
        btn.className = "choice";
        btn.textContent = choice.text;
        btn.onclick = () => chooseOption(choice, event.title);
        choicesDiv.appendChild(btn);
      });
    }

    function chooseOption(choice, eventTitleText) {
      if (!state.alive) return;

      state.economy = clamp(state.economy + (choice.effects.economy || 0));
      state.military = clamp(state.military + (choice.effects.military || 0));
      state.happiness = clamp(state.happiness + (choice.effects.happiness || 0));
      state.stability = clamp(state.stability + (choice.effects.stability || 0));

      resultText.textContent = choice.result;

      addLogEntry(`<strong>[${state.year}] ${eventTitleText}</strong> â€” ${choice.text}`);

      updateStatsUI();

      if (checkGameOver()) {
        return;
      }

      state.year += 1;
      state.turn += 1;
      updateStatsUI();
      saveGame();
    }

    nextTurnBtn.addEventListener("click", () => {
      if (state.alive) {
        showRandomEvent();
      }
    });

    restartBtn.addEventListener("click", () => {
      resetState();
      saveGame();
      logDiv.innerHTML = "";
      resultText.textContent = "";
      gameOverDiv.style.display = "none";
      nextTurnBtn.disabled = false;
      updateStatsUI();
      showRandomEvent();
      addLogEntry("<strong>Oyun yeniden baÅŸladÄ±.</strong>");
    });

    function resetState() {
      state.year = 1453;
      state.turn = 1;
      state.economy = 50;
      state.military = 50;
      state.happiness = 50;
      state.stability = 50;
      state.alive = true;
    }

    function enterGame(isContinue = false) {
      startScreen.style.display = "none";
      gameScreen.style.display = "block";
      updateStatsUI();
      if (!isContinue) {
        logDiv.innerHTML = "";
        addLogEntry("<strong>Oyun baÅŸladÄ±.</strong>");
        showRandomEvent();
      } else {
        addLogEntry("<strong>KaldÄ±ÄŸÄ±n yerden devam ediyorsun.</strong>");
        showRandomEvent();
      }
    }

    // Start screen butonlarÄ±
    newGameBtn.addEventListener("click", () => {
      resetState();
      saveGame();
      enterGame(false);
    });

    continueBtn.addEventListener("click", () => {
      const loaded = loadGame();
      if (!loaded) {
        // kayÄ±t yoksa butonu gizle
        continueBtn.style.display = "none";
        return;
      }
      Object.assign(state, loaded);
      enterGame(true);
    });

    // Ä°lk aÃ§Ä±lÄ±ÅŸ: kayÄ±t var mÄ± kontrol et
    (function init() {
      updateStatsUI();
      const saved = loadGame();
      if (saved && saved.alive) {
        continueBtn.style.display = "block";
      } else {
        continueBtn.style.display = "none";
      }
    })();
  </script>
</body>
</html>
